<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9;IE=8;IE=EDGE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link type="text/css" href="../../dcUIFramework/jquery-easyui/themes/dcjet/easyui.css" rel="stylesheet" />
    <link type="text/css" href="../../dcUIFramework/jquery-easyui/themes/icon.css" rel="stylesheet" />
    <link type="text/css" href="../../res/css/dc.default.css" rel="stylesheet" />
    <script type="text/javascript" src="../../dcUIFramework/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../../dcUIFramework/jquery-easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../dcUIFramework/jquery-easyui/locale/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../dcUIFramework/dc.framework-0.0.1.js"></script>
    <script type="text/javascript" src="../../dc.pageConfig.js"></script>
    <title>MTest Index</title>
</head>
<body>
    <div class="dc-form-wrapper">
        <form>
            <div class="dc-search-wrapper dc-panel">
                <div class="dc-panel-head">
                    <span class="dc-sitePath">当前位置：  </span>
                    <a id="s_search" dcc="button" dpm="page-index-search" class="dc-btn dc-btn-search">查询</a>
                    <a id="s_searchHidden" dcc="button" class="dc-searchHidden dc-btn dc-btn-hideSearch">隐藏查询</a>
                </div>
                <div class="dc-panel-body">
                    <!-- 查询条件 -->
                    <table class="dc-searchTable">
                        <tr>   
                            <th>唯一标识</th>
                            <td><input id="s_oid" dcc="textbox" dcm="oid" /></td>
                            <th>证件关联ID</th>
                            <td><input id="s_certOid" dcc="textbox" dcm="certOid" /></td>
                            <th>料号</th>
                            <td><input id="s_imgNo" dcc="textbox" dcm="imgNo" /></td>
                        </tr>   
                        <tr>   
                            <th>项次</th>
                            <td><input id="s_gNo" dcc="code-autocomplete" dcm="gNo" /></td>
                            <th>商编</th>
                            <td><input id="s_hsCode" dcc="textbox" dcm="hsCode" /></td>
                            <th>品名</th>
                            <td><input id="s_goodDesc" dcc="textbox" dcm="goodDesc" /></td>
                        </tr>   
                        <tr>   
                            <th>料号位置</th>
                            <td><input id="s_position" dcc="decimalbox" dcm="position" /></td>
                            <th>备案量</th>
                            <td><input id="s_maxQuantity" dcc="decimalbox" dcm="maxQuantity" /></td>
                            <th>剩余数量</th>
                            <td><input id="s_leftQuantity" dcc="decimalbox" dcm="leftQuantity" /></td>
                        </tr>   
                        <tr>   
                            <th>材料本体/最小包装是否有3C/CQC</th>
                            <td><input id="s_hasInnerCert" dcc="decimalbox" dcm="hasInnerCert" /></td>
                            <th>IEC、GB或其他执行标准</th>
                            <td><input id="s_standard" dcc="textbox" dcm="standard" /></td>
                            <th>判定日期</th>
                            <td><input id="s_judgeDateBegin" dcc="datebox" dcm="judgeDateBegin" />~<input id="s_judgeDateEnd" dcc="datebox" dcm="judgeDateEnd" /></td>
                        </tr>   
                        <tr>   
                            <th>英文描述</th>
                            <td><input id="s_enDesc" dcc="textbox" dcm="enDesc" /></td>
                            <th>单位</th>
                            <td><input id="s_unit" dcc="textbox" dcm="unit" /></td>
                            <th>厂商</th>
                            <td><input id="s_supply" dcc="textbox" dcm="supply" /></td>
                        </tr>   
                        <tr>   
                            <th>厂商料号/型号</th>
                            <td><input id="s_supplyImgNo" dcc="textbox" dcm="supplyImgNo" /></td>
                            <th>厂别编码</th>
                            <td><input id="s_companyCode" dcc="textbox" dcm="companyCode" /></td>
                            <th>负责采购</th>
                            <td><input id="s_puchaser" dcc="textbox" dcm="puchaser" /></td>
                        </tr>   
                        <tr>   
                            <th>Incoterms</th>
                            <td><input id="s_incoterms" dcc="textbox" dcm="incoterms" /></td>
                            <th>国别/港口</th>
                            <td><input id="s_port" dcc="textbox" dcm="port" /></td>
                            <th>原產國</th>
                            <td><input id="s_origin" dcc="textbox" dcm="origin" /></td>
                        </tr>   
                        <tr>   
                            <th>貿易國</th>
                            <td><input id="s_exportation" dcc="textbox" dcm="exportation" /></td>
                            <th>代办证提醒OID</th>
                            <td><input id="s_warnNeedOid" dcc="textbox" dcm="warnNeedOid" /></td>
                            <th>状态</th>
                            <td><input id="s_status" dcc="decimalbox" dcm="status" /></td>
                        </tr>   
                        <tr>   
                            <th>是否确认(1 已确认/ 2未确认/3 规格图)</th>
                            <td><input id="s_isconfirm" dcc="textbox" dcm="isconfirm" /></td>
                            <th>备注</th>
                            <td><input id="s_remark" dcc="textbox" dcm="remark" /></td>
                            <th></th>
                            <td><input id="s_gsCode" dcc="textbox" dcm="gsCode" /></td>
                        </tr>   
                        <tr>   
                            <th>商检系统扣数量</th>
                            <td><input id="s_hsQuantity" dcc="decimalbox" dcm="hsQuantity" /></td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="dc-toolbar-wrapper dc-panel">
                <div class="dc-panel-body">
                    <a id="t_add" dcc="button" dpm="page-index-add" class="dc-btn dc-btn-add">新增</a>
                    <a id="t_edit" dcc="button" dpm="page-index-edit" class="dc-btn dc-btn-edit">修改</a>
                    <a id="t_del" dcc="button" dpm="page-index-delete" class="dc-btn dc-btn-del">删除</a>
                    <a id="t_import" dcc="button" dpm="page-index-import" class="dc-btn dc-btn-import">导入</a>
                </div>
            </div>
            <div class="dc-grid-wrapper dc-panel">
                <table id="g_table" dcc="datagrid"></table>
            </div>
        </form>
    </div>
</body>

</html>
<script type="text/javascript">
    dcReady(function () {
        //统一页面参数区域
        var moduleUrl = dc.project.backendUrl + "/ZjglCert";

        //控件定义区域
        dc.config = {
            page: {
                pagecode: "page-index"
            },
            //字段验证区域
            fieldValid: {
            },
            //控件配置区域
            control:
            {
                "s_gNo": { code: "abc" },               
                "s_search":{onClick:dc_search},
                "t_add": { "iconCls": "icon-dc-add" ,onClick:dc_add},
                "t_edit": { "iconCls": "icon-dc-edit",onClick:dc_edit },
                "t_del": { "iconCls": "icon-dc-remove",onClick:dc_del },
                "t_import": { "iconCls": "icon-dc-import",onClick:dc_import },
                "g_table": {
                    url: moduleUrl + "/getList",
                    idField: "oid",
                    method: "POST",
                    columns: [[
                        { title: "唯一标识", field: 'oid' }
                        ,{ title: "证件关联ID", field: 'certOid' }
                        ,{ title: "料号", field: 'imgNo' }
                        ,{ title: "项次", field: 'gNo' }
                        ,{ title: "商编", field: 'hsCode' }
                        ,{ title: "品名", field: 'goodDesc' }
                        ,{ title: "料号位置", field: 'position' }
                        ,{ title: "备案量", field: 'maxQuantity' }
                        ,{ title: "剩余数量", field: 'leftQuantity' }
                        ,{ title: "材料本体/最小包装是否有3C/CQC", field: 'hasInnerCert' }
                        ,{ title: "IEC、GB或其他执行标准", field: 'standard' }
                        ,{ title: "判定日期", field: 'judgeDate', formatter: dc.out.dateFormatter }
                        ,{ title: "英文描述", field: 'enDesc' }
                        ,{ title: "单位", field: 'unit' }
                        ,{ title: "厂商", field: 'supply' }
                        ,{ title: "厂商料号/型号", field: 'supplyImgNo' }
                        ,{ title: "厂别编码", field: 'companyCode' }
                        ,{ title: "负责采购", field: 'puchaser' }
                        ,{ title: "Incoterms", field: 'incoterms' }
                        ,{ title: "国别/港口", field: 'port' }
                        ,{ title: "原產國", field: 'origin' }
                        ,{ title: "貿易國", field: 'exportation' }
                        ,{ title: "代办证提醒OID", field: 'warnNeedOid' }
                        ,{ title: "状态", field: 'status' }
                        ,{ title: "是否确认(1 已确认/ 2未确认/3 规格图)", field: 'isconfirm' }
                        ,{ title: "备注", field: 'remark' }
                        ,{ title: "", field: 'gsCode' }
                        ,{ title: "商检系统扣数量", field: 'hsQuantity' }
                    ]]
                }

            }
        };
        //初始化所有控件
        dc.init();

        //事件区域
        //查询
        function dc_search() {
            $('#g_table').datagrid('reload', dc.getModel("form"));
        };
        //新增
        function dc_add() {
            var addUrl = dc.util.getUrl() + ("/Tabs.html?state=add");
            dc.out.redirect(addUrl, "新增");
        };
        //编辑
        function dc_edit() {
            //获取ID
            var ids = dc.getValue("#g_table");
            if (ids && ids.length == 1) {
                var addUrl = dc.util.getUrl() + ("/Tabs.html?state=edit&oid=" + ids[0]);
                dc.out.redirect(addUrl, "编辑");
            }
            else {
                dc.info.alert("有且只能选中一项进行操作");
            }
        };
        //删除
         function dc_del() {
            //获取ID
            var ids = dc.getValue("#g_table");
            if (ids && ids.length > 0) {
                dc.info.confirm("您确定要删除所选择的记录吗?",
                    {
                        fn: function (res) {
                            if (res) {
                                //调用删除
                                dc.get(moduleUrl + "/delete",
                                    { oid: ids.join(",") },
                                    function (data) {
                                        if (data.success) {
                                            dc.info.alert("操作成功");
                                            $('#g_table').datagrid('reload', dc.getModel("form"));
                                            //清除选择
                                            $('#g_table').datagrid('clearSelections');
                                        } else {
                                            console.error(data.data);
                                            dc.info.alert("删除失败");
                                        }
                                    });
                            }
                        }
                    }
                );
            }
            else {
                dc.info.alert("至少选中一项进行操作");
            }
        };
        //导出
        function dc_export() {
            var model = dc.getModel("form");
            window.location.href = moduleUrl + "/export?" + $.param(model);
        };
    });

</script>